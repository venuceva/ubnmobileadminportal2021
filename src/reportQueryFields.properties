
##NBK Trans Log
NBK_TRANS_LOG_REP=(select INSTITUTION_NAME from SERVICES_INSTITUTIONS where INSTITUTION_ID=LT.INSTITUTE )INSTITUTE,(select OPERATORNAME from MN_OPERATORS where  OPERATORID=LT.OPERATOR) OPERATOR,PAYBILL_SHORTCODE,MSISDN,TRANLOG_PK,CREDIT_AC,TO_CHAR(DATE_CREATED,'DD-MM-YYYY HH24:MI:SS') DATE_CREATED,TO_CHAR(POSTING_DATE,'DD-MM-YYYY HH24:MI:SS') POSTING_DATE,TO_CHAR(NARRATION) NARRATION,to_number(TXN_AMOUNT) TXN_AMOUNT,CHANNELID,TRANLOG_PK CONT,DEBIT_AC,BILL_REF_NO,TXN_ID,POSTING_RRN,decode(STATUS,'S','SUCCESS','F','FAILED','P','PENDING') STATUS
NBK_TRANS_LOG_REP_SUB=select (select INSTITUTION_NAME from SERVICES_INSTITUTIONS where INSTITUTION_ID=LT.INSTITUTE )INSTITUTE,(select OPERATORNAME from MN_OPERATORS where  OPERATORID=LT.OPERATOR) OPERATOR,PAYBILL_SHORTCODE,MSISDN,TRANLOG_PK,CREDIT_AC,to_date(DATE_CREATED,'DD-MM-YYYY') DATE_CREATED,to_date(POSTING_DATE,'DD-MM-YYYY') POSTING_DATE,to_char(NARRATION) NARRATION,TXN_AMOUNT,CHANNELID,TRANLOG_PK CONT,DEBIT_AC,BILL_REF_NO,TXN_ID,POSTING_RRN,decode(STATUS,'S','SUCCESS','F','FAILED','P','PENDING') STATUS from TRAN_LOG

BULK_ERROR_REP=CUSTOMERID,MOB_NO,INSTITUTE,substr(REMARKS,0,length(REMARKS)-1) REMARKS,MAKER_DTTM
BULK_ERROR_REP_SUB=select 1 from dual

##NBK Trans Log
ONBOARDING_CUST_REP=MA.CUSTOMER_CODE CUST_ID,MA.FIRST_NAME CUST_NAME,decode(AC.INSTITUTE,'INSTID1','BFUB','INSTID2','IMAL/AMANAH') INST,AC.ACCT_TYPE AC_TYPE,AC.ACCT_NO AC_NO,(select MT.MOBILE_NUMBER  from MOB_CONTACT_INFO_TEMP MT where  (MT.CUST_ID,MT.CREATED_DTTM) = ( select MR.CUST_ID, max(MR.CREATED_DTTM) from MOB_CONTACT_INFO_TEMP MR where MR.CUST_ID=AC.CUST_ID group by MR.CUST_ID )) MOB_NO,MA.CREATED_BY MAK_ID,to_char(MA.DATE_CREATED,'DD-MON-YYYY HH24:MI:SS') MAK_DT,NVl(MA.AUTHID,' ') CHK_ID,NVl(to_char(MA.AUTHDTTM,'DD-MON-YYYY HH24:MI:SS'),' ') CHK_DT,(DECODE(ad.transcode,'fetchRegCustDet','Account Addition','Registration')) CUS_STAT,decode(AP.STATUS,'C','Completed','P','Pending','R','Rejected') AUTH_STAT 
ONBOARDING_CUST_REP_SUB=select MA.CUSTOMER_CODE CUST_ID,MA.FIRST_NAME CUST_NAME,decode(AC.INSTITUTE,'INSTID1','BFUB','INSTID2','IMAL/AMANAH') INST,AC.ACCT_TYPE AC_TYPE,AC.ACCT_NO AC_NO,(select MT.MOBILE_NUMBER  from MOB_CONTACT_INFO_TEMP MT where  (MT.CUST_ID,MT.CREATED_DTTM) in ( select MR.CUST_ID, max(MR.CREATED_DTTM) from MOB_CONTACT_INFO_TEMP MR where MR.CUST_ID=AC.CUST_ID group by MR.CUST_ID )) MOB_NO,MA.CREATED_BY MAK_ID,to_char(MA.DATE_CREATED,'DD-MON-YYYY HH24:MI:SS') MAK_DT,MA.AUTHID CHK_ID,to_char(MA.AUTHDTTM,'DD-MON-YYYY HH24:MI:SS') CHK_DT,(decode((select 'Account Addition' from audit_data ad  where ac.ref_num=ad.detail_3 and transcode='fetchRegCustDet' and detail_3 <> ' '),'Account Addition','Account Addition','Registration')) CUS_STAT,decode(AP.STATUS,'C','Completed','P','Pending','R','Rejected') AUTH_STAT from MOB_CUSTOMER_MASTER_TEMP MA,AUTH_PENDING AP,MOB_CONTACT_INFO_TEMP MT,MOB_ACCT_DATA_TEMP AC 

##NBK Trans Log
USER_AUTHORIZATION_REP=decode(am.relation,'AC','Account Registration','MP','M-Pesa Account Management','UM','User Management') UAM,sum(decode(trunc(a.maker_dttm),trunc(sysdate),1,0)) Tod,sum(decode(a.status,'C',1,0)) comp,sum(decode(a.status,'P',1,0)) Pend,sum(decode(a.status,'R',1,0)) rej, count(*) tot 
USER_AUTHORIZATION_REP_SUB=select decode(am.relation,'AC','Account Registration','MP','M-Pesa Account Management') UAM,sum(decode(trunc(a.maker_dttm),trunc(sysdate),1,0)) Tod,sum(decode(a.status,'C',1,0)) comp,sum(decode(a.status,'P',1,0)) Pend,sum(decode(a.status,'R',1,0)) rej, count(*) tot 

##NBK Trans Log
DAILY_TXN_REP=POSTING_RRN,TO_NUMBER(TXN_AMOUNT/100) TXN_AMOUNT,TXN_ID,DECODE(INSTITUTE,'INSTID1','BFUB','INSTID2','IMAL/AMANAH') INSTITUTE,TXN_TYPE,MSISDN,to_char(DATE_CREATED,'DD-MM-YYYY HH24:MI:SS') DATE_CREATED,DECODE(STATUS,'S','SUCCESS','F','FAILED','R','REVERSAL') STATUS,(SELECT CHANNEL_NAME FROM MOB_CHANNELS C where C.ID=T.CHANNELID) CHANNELID,STATUS_DESC,DEBIT_AC,CREDIT_AC,NARRATION   
DAILY_TXN_REP_SUB=

##NBK Trans Log
MPESA_TXN_REP=POSTING_RRN,TO_NUMBER(TXN_AMOUNT/100) TXN_AMOUNT,TXN_ID,(select STATUS_DESC from MOB_MNO_B2C_LOG M where M.TRANLOG_ID=T.TXN_ID) STATUS_CODE,(select EXTERNAL_SYS_REF_ID from MOB_MNO_B2C_LOG M where M.TRANLOG_ID=T.TXN_ID) EXT_REF_NO,DECODE(INSTITUTE,'INSTID1','BFUB','INSTID2','IMAL/AMANAH') INSTITUTE,(select SERVICE_NAME from MOB_SERVICE_MASTER S where S.SERVICE_CODE=T.TXN_TYPE) TXN_TYPE,MSISDN,to_char(DATE_CREATED,'DD-MM-YYYY HH24:MI:SS') DATE_CREATED,DECODE(STATUS,'S','SUCCESS','F','FAILED','R','REVERSAL') STATUS,(SELECT CHANNEL_NAME FROM MOB_CHANNELS C where C.ID=T.CHANNELID) CHANNELID,STATUS_DESC,DEBIT_AC,CREDIT_AC,NARRATION   
MPESA_TXN_REP_SUB= 

##NBK Trans Log
CUSTOMER_CNT_REP=distinct(MAKER_ID),USERAUTH,MODUSERAUTH,USERSTATUSAUTH,MPESATYPEAUTH ,MPESAMODACDEAUTH,MPESAMODBIDACDEAUTH,MPESABTSTATUSAUTH,MPESABIDSTATUSAUTH,MPESAIDAUTH,NEWACCAUTH,ACCACTDCT,ACCTPINRESET,MODCUSTDETAUTH,DELACCAUTH,MPESAADDBIDAUTH,PRODUCTCREAUTH,MPESAMODBIDSTATUSAUTH,LIMCREAUTH,(ACCACTDCT+ACCTPINRESET) total 
CUSTOMER_CNT_REP_SUB=

##NBK Trans Log
SECURITY_CNT_REP=distinct(C.MAKER_ID),USERAUTH,MODUSERAUTH,USERSTATUSAUTH,MPESATYPEAUTH,MPESAMODACDEAUTH,MPESAMODBIDACDEAUTH,MPESABTSTATUSAUTH,MPESABIDSTATUSAUTH,MPESAIDAUTH,NEWACCAUTH,ACCACTDCT,ACCTPINRESET,MODCUSTDETAUTH,DELACCAUTH,MPESAADDBIDAUTH,PRODUCTCREAUTH,MPESAMODBIDSTATUSAUTH,LIMCREAUTH,(USERAUTH+MODUSERAUTH+USERSTATUSAUTH) TOTAL 
SECURITY_CNT_REP_SUB=

##NBK Trans Log
TXN_TYPE_CNT_REP=(select SERVICE_NAME from MOB_SERVICE_MASTER S where S.SERVICE_CODE=T.TXN_TYPE) TXN_TYPE,sum(decode(STATUS,'S',1,0)) success,sum(decode(status,'F',1,0)) failure,count(*) TOTAL
TXN_TYPE_CNT_REP_SUB=

##NBK Trans Log
MAKER_CNT_REP=distinct(C.MAKER_ID),USERAUTH,MODUSERAUTH,USERSTATUSAUTH,MPESATYPEAUTH ,MPESAMODACDEAUTH,MPESAMODBIDACDEAUTH,MPESABTSTATUSAUTH,MPESABIDSTATUSAUTH,MPESAIDAUTH,NEWACCAUTH,ACCACTDCT,ACCTPINRESET,MODCUSTDETAUTH,DELACCAUTH,MPESAADDBIDAUTH,PRODUCTCREAUTH,MPESAMODBIDSTATUSAUTH,LIMCREAUTH,(MPESATYPEAUTH +MPESAMODACDEAUTH+MPESAMODBIDACDEAUTH+MPESABTSTATUSAUTH+MPESABIDSTATUSAUTH+MPESAIDAUTH+NEWACCAUTH+ACCACTDCT+ACCTPINRESET+MODCUSTDETAUTH+DELACCAUTH+MPESAADDBIDAUTH+MPESAMODBIDSTATUSAUTH) total 
MAKER_CNT_REP_SUB=

##NBK Trans Log
CHECKER_CNT_REP=distinct(C.MAKER_ID),USERAUTH,MODUSERAUTH,USERSTATUSAUTH,MPESATYPEAUTH ,MPESAMODACDEAUTH,MPESAMODBIDACDEAUTH,MPESABTSTATUSAUTH,MPESABIDSTATUSAUTH,MPESAIDAUTH,NEWACCAUTH,ACCACTDCT,ACCTPINRESET,MODCUSTDETAUTH,DELACCAUTH,MPESAADDBIDAUTH,PRODUCTCREAUTH,MPESAMODBIDSTATUSAUTH,LIMCREAUTH,(MPESATYPEAUTH +MPESAMODACDEAUTH+MPESAMODBIDACDEAUTH+MPESABTSTATUSAUTH+MPESABIDSTATUSAUTH+MPESAIDAUTH+NEWACCAUTH+ACCACTDCT+ACCTPINRESET+MODCUSTDETAUTH+DELACCAUTH+MPESAADDBIDAUTH+MPESAMODBIDSTATUSAUTH) total 
CHECKER_CNT_REP_SUB=

##NBK Trans Log
#ADMIN_AUTHORIZATION_REP=decode(am.relation,'AC','Account Registration','MP','M-Pesa Account Management','UM','User Management') UAM,sum(decode(trunc(a.maker_dttm),trunc(sysdate),1,0)) Tod,sum(decode(a.status,'C',1,0)) comp,sum(decode(a.status,'P',1,0)) Pend,sum(decode(a.status,'R',1,0)) rej, count(*) tot 
#ADMIN_AUTHORIZATION_REP_SUB=select decode(am.relation,'AC','Account Registration','MP','M-Pesa Account Management') UAM,sum(decode(trunc(a.maker_dttm),trunc(sysdate),1,0)) Tod,sum(decode(a.status,'C',1,0)) comp,sum(decode(a.status,'P',1,0)) Pend,sum(decode(a.status,'R',1,0)) rej, count(*) tot from auth_master am,auth_pending a 

ADMIN_AUTHORIZATION_REP=  C.maker_id,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='USERAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') USERAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MODUSERAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MODUSERAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='USERSTATUSAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') USERSTATUSAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MPESATYPEAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MPESATYPEAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MPESAMODACDEAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MPESAMODACDEAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MPESAMODBIDACDEAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MPESAMODBIDACDEAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MPESABTSTATUSAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MPESABTSTATUSAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MPESABIDSTATUSAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MPESABIDSTATUSAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MPESAIDAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MPESAIDAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='NEWACCAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') NEWACCAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='ACCACTDCT' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') ACCACTDCT,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='ACCTPINRESET' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') ACCTPINRESET,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MODCUSTDETAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MODCUSTDETAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='DELACCAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') DELACCAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MPESAADDBIDAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MPESAADDBIDAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='PRODUCTCREAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') PRODUCTCREAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='MPESAMODBIDSTATUSAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') MPESAMODBIDSTATUSAUTH,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE='LIMCREAUTH' and C.MAKER_ID=B.MAKER_ID and B.STATUS='C') LIMCREAUTH  
ADMIN_AUTHORIZATION_REP_SUB=select decode(am.relation,'AC','Account Registration','MP','M-Pesa Account Management') UAM,sum(decode(trunc(a.maker_dttm),trunc(sysdate),1,0)) Tod,sum(decode(a.status,'C',1,0)) comp,sum(decode(a.status,'P',1,0)) Pend,sum(decode(a.status,'R',1,0)) rej, count(*) tot from auth_master am,auth_pending a 

DAILY_AUTHORIZATIONS_CREATED_REP= A.HEADING_NAMES,A.AUTH_CODE,DECODE(A.RELATION,'UM','User Management','MP','M-Pesa Account Management','AC','Account Registration','PC','Product Management') AUTHGROUP,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE=A.AUTH_CODE AND B.STATUS='P' AND TO_CHAR(B.MAKER_DTTM)=TO_CHAR(sysdate) ) Today,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE=A.AUTH_CODE AND B.STATUS='C') Authorized,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE=A.AUTH_CODE AND B.STATUS='P') Pending 
DAILY_AUTHORIZATIONS_CREATED_REP_SUB=SELECT A.HEADING_NAMES,A.AUTH_CODE,DECODE(A.RELATION,'UM','User Management','MP','M-Pesa Account Management','AC','Account Registration','PC','Product Management') Relation,(SELECT COUNT(*) FROM AUTH_PENDING B WHERE B.AUTH_CODE=A.AUTH_CODE AND B.STATUS='P' AND TO_CHAR(B.MAKER_DTTM)=TO_CHAR(sysdate)) TodayTotal FROM AUTH_MASTER A ORDER BY RELATION 

##Customer Trans Log
CUSTOMER_TRANS_LOG_REP=ROWNUM SNO,decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)),substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO,to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME,LT.TERMINALNUMBER TERMID,MM.MERCHANT_ID  MERCHANT_ID,lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC,(case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(LT.amount/100) else  0 end) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  to_number(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1))/100 else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status,lt.stan AUTH, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100 else 0 end) TAX,lt.BANKNAME BANK,lt.APPROVEDBY operator_id, uinfo.user_name operator_name, (select office_code||'~'||office_name from BRANCH_MASTER where office_code=SM.location) branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region , (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
CUSTOMER_TRANS_LOG_REP_SUB=select bank, txn_desc, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee, sum(BANKFEE) tot_bank_fee   from (SELECT BANK, TXN_DESC, CNT, TXNAMT, FEE , service_tax , posrrn, cust_fee, mer_fee, (cust_fee - mer_fee) BANKFEE  FROM (SELECT BANKNAME BANK, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE,  SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then  ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100  else 0 end) service_TAX, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N'  THEN to_number(nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0'))/100 ELSE 0 END) cust_fee, sum(CASE WHEN LT.TXNTYPE IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, USER_LOGIN_CREDENTIALS ULC, USER_INFORMATION UINFO where @@CONDITION@@ group by  lt.bankname, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end) )  ) group by bank,txn_desc  order by bank,TXN_DESC desc

##Newly Registered Merchantes 18
NEW_MERCHANT_SETUP_REPORT_REP= MM.MERCHANT_ID, PBM.OFFICE_NAME , TRUNC(MM.MAKER_DTTM) MAKER_dTTM, MM.MERCHANT_NAME, MM.LOCATION, MM.EMAIL, MM.MOBILE_NO, DECODE(MM.STATUS,'A','Active','iN-aCTIVE') STATUS, MM.MAKER_ID, MM.MERCHANT_TYPE, MM.FLOAT_AMOUNT, MM.TRANSACTION_LIMIT, MM.REF_NUM
NEW_MERCHANT_SETUP_REPORT_REP_SUB=

##Newly Registered Teriminals 18
TERMINAL_SETUP_REPORT_REP= TM.MERCHANT_ID, TM.TERMINAL_ID, TM.TERMINAL_USAGE, TM.SERIAL_NO, DECODE(TM.STATUS,'A','Active','In-Active') status, trunc(TM.TERMINAL_DATE) terminal_date, TM.MAKER_ID, trunc(TM.maker_dttm) maker_dttm
TERMINAL_SETUP_REPORT_REP_SUB=

## Ending
##Customer Commission Rpt
CUSTOMER_COMMISSION_RPT_REP = ROWNUM SNO, decode(LT.TXNTYPE,'CDP', rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)), substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME, LT.TERMINALNUMBER TERMID, MM.MERCHANT_ID  MERCHANT_ID, lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, TO_NUMBER(lt.amount/100) TXNAMT, to_number(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1))/100 fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then 'APPROVED' else 'DECLINED' end)  status, lt.stan AUTH,(case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100 else 0 end) TAX, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, (select office_code||'~'||office_name from BRANCH_MASTER where office_code=SM.location) branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region, (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
CUSTOMER_COMMISSION_RPT_REP_SUB = select bank, txn_desc, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee, sum(BANKFEE) tot_bank_fee   from (SELECT BANK, TXN_DESC, CNT, TXNAMT, FEE , service_tax , posrrn, cust_fee, mer_fee, ((cust_fee +service_TAX ) - mer_fee) BANKFEE  FROM (SELECT BANKNAME BANK, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then  ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100  else 0 end) service_TAX, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N'  THEN to_number(nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0'))/100 ELSE 0 END) cust_fee, sum(CASE WHEN LT.TXNTYPE IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee  FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, USER_LOGIN_CREDENTIALS ULC, USER_INFORMATION UINFO  where @@CONDITION@@  group by  lt.bankname, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)    )  ) group by bank,txn_desc  order by bank,TXN_DESC desc

##Merchant Trans Log
MERCHANT_TRAN_LOG_REP=ROWNUM SNO, decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)),substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME, LT.TERMINALNUMBER TERMID, MM.MERCHANT_ID  MERCHANT_ID, lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(LT.amount/100) else  0 end) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  to_number(substr(LT.fee_code,instr(LT.fee_code,'#')+1))/100  else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status, lt.stan AUTH, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100 else 0 end) TAX, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, (select office_code||'~'||office_name from BRANCH_MASTER where office_code=SM.location) branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region , (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
MERCHANT_TRAN_LOG_REP_SUB=select  merch_id, TXN_DESC, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee from ( SELECT  merch_id, CNT, TXN_DESC, TXNAMT, FEE , service_tax , posrrn, cust_fee, mer_fee from ( SELECT lt.MERCHANTID  merch_id, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then  ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100  else 0 end) service_TAX, SUM(to_number(nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0'))/100)  cust_fee, sum(CASE WHEN   LT.RESPONSECODE='00' and LT.ISREVERSED='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, USER_LOGIN_CREDENTIALS ULC, USER_INFORMATION UINFO  where  @@CONDITION@@  group by  lt.posrrn, lt.MERCHANTID,(case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end) )    ) group by  TXN_DESC,merch_id order by merch_id,TXN_DESC desc

##Merachant Fee settlement
MERCHANT_FEE_SETTLEMENT=ROWNUM SNO, decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)),substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME, LT.TERMINALNUMBER TERMID, MM.MERCHANT_ID  MERCHANT_ID, lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(LT.amount/100) else  0 end) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  to_number(substr(LT.fee_code,instr(LT.fee_code,'#')+1))/100  else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status, lt.stan AUTH, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then nvl((select sum(TO_NUMBER(nvl(amount,'0')/100)) from TBL_TRANLOG where posrrn=lt.POSRRN and TXNTYPE='TFE'),'0') else 0 end) TAX, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, (select office_code||'~'||office_name from BRANCH_MASTER where office_code=SM.location) branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region , (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
MERCHANT_FEE_SETTLEMENT_SUB=select  merch_id, TXN_DESC, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee from ( SELECT  merch_id, CNT, TXN_DESC, TXNAMT, FEE , service_tax , posrrn, cust_fee, mer_fee from ( SELECT lt.MERCHANTID  merch_id, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then nvl((select sum(TO_NUMBER(nvl(amount,'0')/100)) from TBL_TRANLOG where posrrn=lt.POSRRN and TXNTYPE='TFE'),'0') else 0 end) service_TAX, SUM(to_number(nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0'))/100)  cust_fee, sum(CASE WHEN   LT.RESPONSECODE='00' and LT.ISREVERSED='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, USER_LOGIN_CREDENTIALS ULC, USER_INFORMATION UINFO  where  @@CONDITION@@  group by  lt.posrrn, lt.MERCHANTID,(case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end) )    ) group by  TXN_DESC,merch_id order by merch_id,TXN_DESC desc

## Bank Transaction per agent / branch / Location
BANK_TRAN_PER_AGENT_BANK_LOG= ROWNUM SNO, decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM, length(LT.CUSTOMERACCOUNTNUM)-3, length(LT.CUSTOMERACCOUNTNUM)), substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME, LT.TERMINALNUMBER TERMID, MM.MERCHANT_ID  MERCHANT_ID, lt.rrn  TRACENO, pbm.office_name mer_location, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(LT.amount/100) else  0 end) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  to_number(substr(LT.fee_code,instr(LT.fee_code,'#')+1))/100  else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status, lt.stan AUTH, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then nvl((select sum(TO_NUMBER(nvl(amount,'0')/100)) from TBL_TRANLOG where posrrn=lt.POSRRN and TXNTYPE='TFE'),'0') else 0 end) TAX, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, (select office_code||'~'||office_name from BRANCH_MASTER where office_code=SM.location) branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region , (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
BANK_TRAN_PER_AGENT_BANK_LOG_SUB= select  merch_id, BRANCH,  TXN_DESC, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee from ( SELECT merch_id, BRANCH, CNT, TXN_DESC, TXNAMT, FEE , service_tax , posrrn, cust_fee, mer_fee from ( SELECT lt.MERCHANTID  merch_id,  Pbm.OFFICE_NAME  BRANCH, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(to_number(LT.CUSTOMER_FEE/100)) FEE, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then nvl((select sum(TO_NUMBER(nvl(amount,'0')/100)) from TBL_TRANLOG where posrrn=lt.POSRRN and TXNTYPE='TFE'),'0') else 0 end) service_TAX, SUM(to_number(substr(fee_code,1,instr(fee_code,'#')-1))/100) cust_fee, sum(CASE WHEN   LT.RESPONSECODE='00' and LT.ISREVERSED='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG lt,  TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, user_login_credentials ulc, user_information uinfo WHERE  @@CONDITION@@ group by  lt.posrrn,Pbm.OFFICE_NAME, lt.MERCHANTID,(case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end),MM.LOCATION )  order by merch_id ) group by  BRANCH,merch_id,TXN_DESC

## Service Tax Transaction Report
SERVICE_TAX_TRANS_REP= ROWNUM SNO,decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)),substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO,to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME,LT.TERMINALNUMBER TERMID,MM.MERCHANT_ID  MERCHANT_ID,lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC,(case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(LT.amount/100) else  0 end) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  to_number(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1))/100 else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status,lt.stan AUTH, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100 else 0 end) TAX,lt.BANKNAME BANK,lt.APPROVEDBY operator_id, uinfo.user_name operator_name, (select office_code||'~'||office_name from BRANCH_MASTER where office_code=SM.location) branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region , (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
SERVICE_TAX_TRANS_REP_SUB= select bank, txn_desc, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee, sum(BANKFEE) tot_bank_fee   from (SELECT BANK, TXN_DESC, CNT, TXNAMT, FEE , service_tax , posrrn, cust_fee, mer_fee, ((cust_fee +service_TAX ) - mer_fee) BANKFEE  FROM (SELECT BANKNAME BANK, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE,  SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then  ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100  else 0 end) service_TAX, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N'  THEN to_number(nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0'))/100 ELSE 0 END) cust_fee, sum(CASE WHEN LT.TXNTYPE IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, USER_LOGIN_CREDENTIALS ULC, USER_INFORMATION UINFO where @@CONDITION@@ group by  lt.bankname, lt.posrrn, (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end) )  ) group by bank,txn_desc  order by bank,TXN_DESC desc

## Merchant Modified Report
MODIFIED_MERCHANT_RPT= mer.MERCHANT_ID, mer.MERCHANT_NAME, mer.LOCATION, mer.MANAGER_NAME, mer.EMAIL, mer.ADDRESS, mer.PO_BOX_NO, mer.MOBILE_NO, mer.MAKER_ID, mer.MAKER_DTTM, mer.MERCHANT_TYPE, mer.CITY, mer.AGEN_OR_BILLER, mer.FLOAT_AMOUNT, TRANSACTION_LIMIT, mer.REF_NUM
MODIFIED_MERCHANT_RPT_SUB=

##Users Under Terminal
USER_TERMINAL_REPORT= DISTINCT USER_ID,TERMINAL_ID,STORE_ID,MERCHANT_ID,TO_CHAR(MAKER_DTTM,'DD-Mon-YYYY') DATE1,MAKER_ID
USER_TERMINAL_REPORT_SUB=

##Bank Transaction Log
BANK_TRANS_LOG_REP = ROWNUM SNO, decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)),substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME, LT.TERMINALNUMBER TERMID, MM.MERCHANT_ID  MERCHANT_ID, lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE INQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, TO_NUMBER(lt.amount/100) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1)/100) else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status, lt.stan AUTH, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100 else 0 end) TAX, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, SM.STORE_ID||'~'||SM.STORE_NAME branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region, pbm.office_name brn_name , ((case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1)/100) else  0 end) - (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,instr(LT.fee_code,'#')+1)/100) else  0 end)) bank_fee, (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
BANK_TRANS_LOG_REP_SUB = select bank,BRN_NAME,txn_desc, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee, sum(BANKFEE) tot_bank_fee   from (SELECT BANK,BRN_NAME, TXN_DESC, CNT,TXNAMT,FEE ,service_tax ,posrrn,cust_fee,mer_fee,(cust_fee  - mer_fee) BANKFEE  FROM (SELECT BANKNAME BANK, lt.posrrn, PBM.OFFICE_NAME BRN_NAME,  (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then  ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100  else 0 end) service_TAX, SUM(case when lt.txntype IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N'  THEN to_number(substr(fee_code,1,instr(fee_code,'#')-1))/100 ELSE 0 END) cust_fee, sum(CASE WHEN LT.TXNTYPE IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, user_login_credentials ulc, user_information uinfo where @@CONDITION@@ group by  lt.bankname, lt.posrrn, PBM.OFFICE_NAME,  (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)) order by BRN_NAME,Bank)  group by BRN_NAME,bank,txn_desc


MERCHANT_TERMINAL_SUMMARY= TM.MERCHANT_ID, TM.TERMINAL_ID, TM.TERMINAL_USAGE, TM.SERIAL_NO, DECODE(TM.STATUS,'A','Active','In-Active') status, trunc(TM.TERMINAL_DATE) terminal_date, TM.MAKER_ID, trunc(TM.maker_dttm) maker_dttm
MERCHANT_TERMINAL_SUMMARY_SUB= select TM.MERCHANT_ID,COUNT(*) TER_CNT from  BRANCH_MASTER PBM, terminal_master TM, MERCHANT_MASTER MM where @@CONDITION@@ GROUP BY TM.MERCHANT_ID


##Audit Log
DAILY_AUDIT_RPT_REP=ROWNUM SNO,A.CHANNEL_ID CH_ID,nvl(A.NET_ID,' ') NETID,A.DATETIME DTTM,nvl(CML.MENU_NAME,' ') MENUNAME,nvl(A.DATA_1,' ') DATA1,nvl(A.CARD_NO,' ') V_CARD,nvl(A.MESSAGE,' ') V_MESSAGE
DAILY_AUDIT_RPT_REP_SUB=SELECT ROWNUM SNO,A.CHANNEL_ID CH_ID,nvl(A.NET_ID,' ') NETID,A.DATETIME DTTM,nvl(CML.MENU_NAME,' ') MENUNAME,nvl(A.DATA_1,' ') DATA1,nvl(A.CARD_NO,' ') V_CARD,nvl(A.MESSAGE,' ') V_MESSAGE

##Bank Commission Postings Rpt Log
##BANK_COMMISSION_RPT_REP= ROWNUM SNO, decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)),substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME, LT.TERMINALNUMBER TERMID, MM.MERCHANT_ID  MERCHANT_ID, lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE INQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, TO_NUMBER(lt.amount/100) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1)/100) else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status, lt.stan AUTH, nvl((select TO_NUMBER(amount/100) from TBL_TRANLOG where posrrn=LT.posrrn and TXNTYPE='TFE' ),'0') TAX, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, SM.STORE_ID||'~'||SM.STORE_NAME branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region, pbm.office_name brn_name , ((case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1)/100) else  0 end) - (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,instr(LT.fee_code,'#')+1)/100) else  0 end)) bank_fee, (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
##BANK_COMMISSION_RPT_REP_SUB= select bank,BRN_NAME,txn_desc, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee, sum(BANKFEE) tot_bank_fee   from (SELECT BANK,BRN_NAME, TXN_DESC, CNT,TXNAMT,FEE ,service_tax ,posrrn,cust_fee,mer_fee,(cust_fee  - mer_fee) BANKFEE  FROM (SELECT BANKNAME BANK, lt.posrrn, PBM.OFFICE_NAME BRN_NAME,  (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE, nvl((select sum(TO_NUMBER(nvl(amount,'0')/100)) from TBL_TRANLOG where posrrn=lt.POSRRN and TXNTYPE='TFE'),'0') service_TAX, SUM(case when lt.txntype IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N'  THEN to_number(substr(fee_code,1,instr(fee_code,'#')-1))/100 ELSE 0 END) cust_fee, sum(CASE WHEN LT.TXNTYPE IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, user_login_credentials ulc, user_information uinfo where @@CONDITION@@ group by  lt.bankname, lt.posrrn, PBM.OFFICE_NAME,  (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)) order by BRN_NAME,Bank)  group by BRN_NAME,bank,txn_desc
BANK_COMMISSION_RPT_REP= ROWNUM SNO, decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)),substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME, LT.TERMINALNUMBER TERMID, MM.MERCHANT_ID  MERCHANT_ID, lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE INQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, TO_NUMBER(lt.amount/100) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1)/100) else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status, lt.stan AUTH, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100 else 0 end) TAX, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, SM.STORE_ID||'~'||SM.STORE_NAME branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region, pbm.office_name brn_name , ((case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1)/100) else  0 end) - (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,instr(LT.fee_code,'#')+1)/100) else  0 end)) bank_fee, (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
BANK_COMMISSION_RPT_REP_SUB= select bank,BRN_NAME,txn_desc, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee, sum(BANKFEE) tot_bank_fee   from (SELECT BANK,BRN_NAME, TXN_DESC, CNT,TXNAMT,FEE ,service_tax ,posrrn,cust_fee,mer_fee,(cust_fee  - mer_fee) BANKFEE  FROM (SELECT BANKNAME BANK, lt.posrrn, PBM.OFFICE_NAME BRN_NAME,  (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then  ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100  else 0 end) service_TAX, SUM(case when lt.txntype IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N'  THEN to_number(substr(fee_code,1,instr(fee_code,'#')-1))/100 ELSE 0 END) cust_fee, sum(CASE WHEN LT.TXNTYPE IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, user_login_credentials ulc, user_information uinfo where @@CONDITION@@ group by  lt.bankname, lt.posrrn, PBM.OFFICE_NAME,  (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)) order by BRN_NAME,Bank)  group by BRN_NAME,bank,txn_desc

#BANK FEE Settlement Report
BANK_FEE_SETTLEMENT_RPT= ROWNUM SNO, decode(LT.TXNTYPE,'CDP',rpad('X',length(LT.CUSTOMERACCOUNTNUM)-3,'X')||substr(LT.CUSTOMERACCOUNTNUM,length(LT.CUSTOMERACCOUNTNUM)-3,length(LT.CUSTOMERACCOUNTNUM)),substr(LT.PAN,0,5)||'XXXXXX'||substr(LT.PAN,10,16)) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME, LT.TERMINALNUMBER TERMID, MM.MERCHANT_ID  MERCHANT_ID, lt.rrn  TRACENO, DECODE(LT.TXNTYPE, 'PUR','PURCHASE','CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE INQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, TO_NUMBER(lt.amount/100) TXNAMT, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1)/100) else  0 end) fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  to_number(substr(LT.fee_code,instr(LT.fee_code,'#')+1))/100  else  0 end) merchant_fee, lt.stan AUTH, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100 else 0 end) TAX, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, SM.STORE_ID||'~'||SM.STORE_NAME branch_name, (SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region, pbm.office_name brn_name , ((case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,1,instr(LT.fee_code,'#')-1)/100) else  0 end) - (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  TO_NUMBER(substr(LT.fee_code,instr(LT.fee_code,'#')+1)/100) else  0 end)) bank_fee, (select FULLDESCRIPTION from TBL_RESPONSE_CODES where BANKCODE=LT.RESPONSECODE and rownum < 2) DESCR
BANK_FEE_SETTLEMENT_RPT_SUB= select bank,BRN_NAME,txn_desc, sum(TXNAMT) TXN_AMOUNT, sum(cnt) tot_cnt, sum(fee) tot_fee, sum(service_tax) tot_servicetax, sum(cust_fee) tot_cust_fee, sum(mer_fee) tot_mer_fee, sum(BANKFEE) tot_bank_fee   from (SELECT BANK,BRN_NAME, TXN_DESC, CNT,TXNAMT,FEE ,service_tax ,posrrn,cust_fee,mer_fee,(cust_fee  - mer_fee) BANKFEE  FROM (SELECT BANKNAME BANK, lt.posrrn, PBM.OFFICE_NAME BRN_NAME,  (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)  TXN_DESC, count(*) cnt, SUM(to_number(LT.AMOUNT/100)) TXNAMT , SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then to_number(LT.CUSTOMER_FEE/100) else 0 end) FEE, SUM(case when lt.RESPONSECODE='00' and lt.isreversed='N' then  ((nvl(substr(fee_code,1,instr(fee_code,'#')-1),'0')/100) * 10)/100  else 0 end) service_TAX, SUM(case when lt.txntype IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N'  THEN to_number(substr(fee_code,1,instr(fee_code,'#')-1))/100 ELSE 0 END) cust_fee, sum(CASE WHEN LT.TXNTYPE IN ('CDP','WDL','BEQ','PUR') and lt.RESPONSECODE='00' and lt.isreversed='N' THEN to_number(substr(fee_code,instr(fee_code,'#')+1))/100 ELSE 0 END) mer_fee FROM TBL_TRANLOG LT, TERMINAL_MASTER TM, STORE_MASTER SM, BRANCH_MASTER PBM,  MERCHANT_MASTER MM, user_login_credentials ulc, user_information uinfo where @@CONDITION@@ group by  lt.bankname, lt.posrrn, PBM.OFFICE_NAME,  (case when lt.RESPONSECODE='00' and lt.isreversed='N' then 'SUCCESS' else 'DECLINED' end)) order by BRN_NAME,Bank)  group by BRN_NAME,bank,txn_desc


##Merchant Commission Report
MERCHANT_COMMISSION_RPT_REP=ROWNUM SNO, decode(LT.TXNTYPE,'CDP',LT.CUSTOMERACCOUNTNUM,LT.PAN) CARD_NO,to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME,LT.TERMINALNUMBER TERMID,MM.MERCHANT_ID||'-'||MM.MERCHANT_NAME MERCHANT_ID,lt.rrn  TRACENO,DECODE(LT.TXNTYPE, 'CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)    TXN_DESC,TO_NUMBER(lt.amount/100) TXNAMT,CUSTOMER_FEE/100 fee, (case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' then  'APPROVED' else  'DECLINED' end)  status, lt.stan AUTH, lt.BANKNAME BANK, lt.APPROVEDBY operator_id, uinfo.user_name operator_name, (select office_code||'~'||office_name from BRANCH_MASTER where office_code=SM.location) branch_name,(SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region ,(SELECT TO_NUMBER(txn_amount/100) from FINANCIAL_POST_TXN where POSRRN=LT.POSRRN AND FINANCIAL_CODE='MERACC') merchant_fee
MERCHANT_COMMISSION_RPT_REP_SUB=SELECT mas.merchant_name,count(*) txn_cnt,   LT.MERCHANTID  MERCHANT_ID, DECODE(LT.TXNTYPE, 'CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM','HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, SM.STORE_ID branch_id,SM.STORE_NAME branch_name,  sum((SELECT TO_NUMBER(txn_amount/100) from FINANCIAL_POST_TXN where POSRRN=LT.POSRRN AND FINANCIAL_CODE='MERACC')) TXNAMT   FROM TBL_TRANLOG LT , STORE_MASTER SM , MERCHANT_Master mas, TERMINAL_MASTER TM ,user_login_credentials ulc, user_information uinfo,BRANCH_MASTER PBM  WHERE @@CONDITION@@  group by mas.merchant_name,   LT.MERCHANTID, SM.STORE_ID ,SM.STORE_NAME,DECODE(LT.TXNTYPE, 'CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)

###Bank to Merchant Settlement Report
BANK_ONLINE_MECHANT_SETTLEMET_RPT_REP= ROWNUM SNO, decode(LT.TXNTYPE,'CDP',LT.CUSTOMERACCOUNTNUM,LT.PAN) CARD_NO, to_char(LT.TXNDATE,'DD-Mon-YYYY HH24:MI:SS')  TXN_DATE_TIME,LT.TERMINALNUMBER TERMID,MM.MERCHANT_ID||'-'||MM.MERCHANT_NAME MERCHANT_ID,lt.rrn  TRACENO,DECODE(LT.TXNTYPE, 'CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL','MER', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)    TXN_DESC,TO_NUMBER(lt.amount/100) TXNAMT,CUSTOMER_FEE/100 fee,(case when LT.RESPONSECODE='00' and LT.ISREVERSED='N' and LT.REVERSALREQUIRED='N' then  'APPROVED' else  'DECLINED' end)  status, lt.stan AUTH, lt.BANKNAME BANK, lt.APPROVEDBY operator_id,  uinfo.user_name operator_name, (select office_code||'~'||office_name from BRANCH_MASTER where office_code=SM.location) branch_name,(SELECT REGION_CODE||'~'||REGION FROM REGION_MASTER WHERE REGION_CODE=PBM.REGION_CODE AND OFFICE_CODE=PBM.OFFICE_CODE) region,LT.MERACCOUNTNUM ,LT.POSRRN
BANK_ONLINE_MECHANT_SETTLEMET_RPT_REP_SUB=SELECT mas.merchant_name,count(*) txn_cnt,   LT.MERCHANTID  MERCHANT_ID, DECODE(LT.TXNTYPE, 'CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM','HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)      TXN_DESC, SM.STORE_ID branch_id,SM.STORE_NAME branch_name,  sum((SELECT TO_NUMBER(txn_amount/100) from FINANCIAL_POST_TXN where POSRRN=LT.POSRRN AND FINANCIAL_CODE='MERACC')) TXNAMT   FROM TBL_TRANLOG LT , STORE_MASTER SM , MERCHANT_Master mas, TERMINAL_MASTER TM ,user_login_credentials ulc, user_information uinfo,BRANCH_MASTER PBM  WHERE @@CONDITION@@  group by mas.merchant_name,   LT.MERCHANTID, SM.STORE_ID ,SM.STORE_NAME,DECODE(LT.TXNTYPE, 'CDP', 'CASH DEPOSIT', 'WDL', 'CASH WITHDRAWAL', 'HDM', 'HUDUMA', 'BEQ', 'BALANCE ENQUIRY', 'MST', 'MINI STATEMENT', 'FTR','FUND TRANSFER', LT.TXNTYPE)



##Report Case
REPORT_CASE_RPT_REP= ROWNUM SNO,FT.MOBNUM,FT.TXN_AMOUNT,FT.DATE_CREATED,FT.FRAUD_DTTM,FT.REQUEST_CHANNEL,FT.ERROR_DESC,FT.FRDPK,DECODE(FT.MON_STATUS,'O','Open','N','New','C','Cloased','E','Esclated') MON_STATUS,FT.TRPK
REPORT_CASE_RPT_REP_SUB=select ROWNUM SNO,FT.MOBNUM,FT.TXN_AMOUNT,FT.DATE_CREATED,FT.FRAUD_DTTM,FT.REQUEST_CHANNEL,FT.ERROR_DESC,FT.FRDPK,FT.MON_STATUS,FT.TRPK